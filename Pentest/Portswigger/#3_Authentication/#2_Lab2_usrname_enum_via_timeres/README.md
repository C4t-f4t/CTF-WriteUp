# Lab: Username enumeration via response timing

# 1. Vulnerable

Ta thử đăng nhập vào bằng tên tài khoản của mình

![vuln.png](/images/vuln.png)

Ta thấy thời gian response ngắn với đúng mật khẩu ngắn

![vuln1.png](/images/vuln1.png)

Thời gian response lâu với mật khẩu dài

Có vẻ trang web sẽ check từng ký tự rồi so sánh với mật khẩu gốc khiến thời gian response sẽ kéo dài nếu `username` đúng

-> Sử dụng điều này để `brute-force` `username`

# 2. Exploit

Bởi vì trong tất cả các `username` nếu có trong cơ sở dữ liệu thì mật khẩu dài mới khiến thời gian delay dài vậy nên ta sẽ tìm ra được đúng `victim's username`

![vuln2.png](/images/vuln2.png)

Ở đây có 1 điều đó là nếu sử dụng 1 ip để đăng nhập sai nhiều lần thì trang web sẽ block 30s

-> fake ip bằng `X-forwarded-for`

 - `X-forwarded-for` chính là 1 phần của giao thức HTTP mà ta gửi request đến máy chủ thông qua máy trung gian và tham số ip chính là ip của máy trung gian đó

-> Ta chỉ cần thay đổi tham số ip này thì trang web sẽ không block và dễ dàng `brute-force`

![vuln3.png](/images/vuln3.png)

Sau khi đã có tài khoản thì việc còn lại là tiếp tục fake ip và `brute-force` `password`

![vuln4.png](/images/vuln4.png)