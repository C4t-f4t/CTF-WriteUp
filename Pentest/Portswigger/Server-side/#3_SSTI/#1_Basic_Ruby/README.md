# Lab: Basic server-side template injection

# 1. Vulnerable

Khi vào trang web và nhấp vào sản phẩm đầu tiên ta sẽ có như sau:

![vuln0.png](images/vuln0.png)

Link url lúc đó là: `/?message=Unfortunately this product is out of stock`

Vậy chương trình đã lấy tham số `message` để làm giá trị đầu vào cho 1 hàm nào đó để in ra

-> Dễ dính `ssti`

# 2. Exploit

Khi đã xác định được nơi có thể đã bị `SSTI` thì ta sẽ test payloads phía dưới

![vuln1.png](images/vuln1.png)

Sau khi đã test hết các payload xong thì ta có thể sử dụng 

```
<%= 7*7 %>
```

![vuln2.png](images/vuln2.png)

Kế đến, gọi hàm system và xem địa chỉ của tệp `morale.txt` và xóa thôi

![vuln3.png](images/vuln3.png)