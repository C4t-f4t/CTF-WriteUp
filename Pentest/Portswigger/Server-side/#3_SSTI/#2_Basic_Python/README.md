# Lab: Basic server-side template injection (code context)

# 1. Vulnerable

Ở bài lab này ta sẽ được cấp 1 tài khoản và lựa chọn option khi bình luận sẽ hiển thị tên như nào điều này gây ra `SSTI`

# 2. Exploit

![img1.png](images/img1.png)

Ở đây ta sẽ có các options để lựa chọn tên được hiển thị khi ta post comment

![img0.png](images/img0.png)

Chương trình lấy tham số của `blog-post-author-display` và ta sẽ thử thêm vào đó 1 chuỗi ký tự nào đó

![img2.png](images/img2.png)

Ngay lập tức tên hiển thị của ta đã được thay đổi

![img4.png](images/img4.png)

Thử payload `ssti` và lỗi hiển thị ta thấy đây là trang được viết bằng python

![img3.png](images/img3.png)

Tiếp đó ta sẽ đóng các hàm trước đó và tạo 1 hàm gọi system mới và getshell thôi

payload: 
```
}}+{%import+os;os.system('ls')%}
```