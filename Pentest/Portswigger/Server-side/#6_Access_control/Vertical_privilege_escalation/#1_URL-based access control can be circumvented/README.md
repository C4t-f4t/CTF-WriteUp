# Lab: URL-based access control can be circumvented

# 1. Vulnerable

Trang web đã block tất cả những người dùng thuộc mảng `managers`

```sh
DENY: POST, /admin/deleteUser, managers
```

Khi ta gửi 1 request đến sever thì sever sẽ chặn hết post có chứa url bị chặn kia

Nhưng bên phía back-end lại sử dụng 1 framework hỗ trợ header `X-Original-URL`

`X-Original-URL` là 1 header http được dùng để ghi đè vào url ban đầu

```sh
POST /?username=admin HTTP/1.1
X-Original-URL: /admin/deleteUser
```

Khi đó trang web sẽ không chặn phương thức POST của ta và ta ghi đè vào url ban đầu để truy cập vào `/admin/deleteUser` với param `username=admin`

# 2. Exploit

