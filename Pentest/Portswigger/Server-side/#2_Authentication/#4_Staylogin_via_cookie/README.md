# Lab: Brute-forcing a stay-logged-in cookie

# 1. Vulnerable

Ở lab này sẽ cho ta account cá nhân và `victim's username`

Trang web này có chức năng mới đó là `stay logged in`

![vuln0.png](images/vuln0.png)

Chức năng này sẽ lưu trữ `cookie` của ta lại và lần sau ta sẽ không cần đăng nhập để vào nữa

![vuln1.png](images/vuln1.png)

Ta sẽ lợi dụng cookie này để loggin `victim's account`

# 2. Exploit

Đầu tiên khi đã có 1 list password rồi thì ta cứ `brute-force` đã

![vuln2.png](images/vuln2.png)

Trang web đã chặn đăng nhập nhiều lần dù mình có thử `X-Forwarded-For`

Check lại cookie 1 lần 

![vuln3.png](images/vuln3.png)

Do phần sau wiener: là 32 ký tự (chính là độ dài bắt buộc của 1 bộ hash md5)

-> cookie được tính theo base64 encode của `username:md5(password)`

Bắt đầu `brute-force` cookie

![vuln4.png](images/vuln4.png)

Do đã có format của cookie nên mình sẽ làm như sau: 

md5(password) -> cộng đầu chuỗi với `carlos:` -> base64_encode toàn bộ chuỗi

![solved.png](images/solved.png)