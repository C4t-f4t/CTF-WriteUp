# Password reset broken logic

# 1. Vulnerable:

Bài này chứa lỗi logic ở hàm đổi mật khẩu khi không check token khi đổi mật khẩu

# 2. Exploit:

Ta sẽ sử dụng chức năng đổi mật khẩu của account của bản thân

![vuln.png](images/vuln.png)

Truy cập vào link đổi mật khẩu và đổi mật khẩu mới 

![vuln2.png](images/vuln2.png)

Sau khi đổi mật khẩu mới thì trang web đưa ta đến trang chủ với tài khoản và mật khẩu đã được reset

![vuln3.png](images/vuln3.png)

Để ý thấy ở đây giao thức `POST` đã gửi lên `username` và `new-password` trước khi cho ta login vào, ta sẽ lợi dụng lỗi ở đây để gửi lại yêu cầu đổi mật khẩu với `victim's username`

![vuln4.png](images/vuln4.png)

Như vậy là với đúng token cũ thì ta vẫn được chấp nhận đổi mật khẩu của `carlos`

Login với `victim's username` và `new-password`

![vuln5.png](images/vuln5.png)